# Railway Configuration for Remember Me Monorepo
# This file configures Railway to deploy both API and Worker services

# Default service configuration (API)
[build]
builder = "DOCKERFILE"
dockerfilePath = "apps/api/Dockerfile"
# Force rebuild on every deploy (no cache)
# Note: Railway may cache layers, but DEPLOY_TRIGGER.txt should bust cache

[deploy]
healthcheckPath = "/api/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Worker service configuration
# Note: Railway requires separate service configuration in Dashboard
# This file is for the default (API) service
# Worker service must be configured manually in Railway Dashboard:
# - Service Name: "remember_me/worker" (or "worker")
# - Dockerfile Path: "apps/api/Dockerfile.worker" ⚠️ CRITICAL
# - Custom Start Command: MUST BE EMPTY (Dockerfile has CMD)
# - No healthcheck (worker doesn't serve HTTP)
# - Start Command: handled by Dockerfile CMD ["node", "dist/worker.main.js"]
