# ============================================
# API Production Environment Variables
# ============================================
# Copy this file to .env.production and fill in all REQUIRED values
# DO NOT commit .env.production to git

# ============================================
# REQUIRED - Core Configuration
# ============================================

# Database
DATABASE_URL=postgresql://user:password@host:5432/dbname?schema=public
# REQUIRED: PostgreSQL connection string from Railway

# JWT Authentication
JWT_SECRET=your-super-secret-jwt-key-min-32-chars-change-in-production
# REQUIRED: Secret key for JWT access tokens (min 32 characters, use strong random string)
JWT_EXPIRES_IN=15m
# REQUIRED: Access token expiration (default: 15m)

JWT_REFRESH_SECRET=your-super-secret-refresh-key-min-32-chars-change-in-production
# REQUIRED: Secret key for JWT refresh tokens (min 32 characters, use strong random string)
JWT_REFRESH_EXPIRES_IN=7d
# REQUIRED: Refresh token expiration (default: 7d)

# CORS & Frontend
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
# REQUIRED: Comma-separated list of allowed frontend origins (no trailing slashes)
FRONTEND_URL=https://yourdomain.com
# REQUIRED: Frontend URL for redirects and email links (no trailing slash)

# ============================================
# REQUIRED - Queue & Worker Configuration
# ============================================

QUEUE_MODE=bullmq
# REQUIRED in production: Must be 'bullmq' for production (or 'db' for fallback)
# Use 'db' only if Redis is unavailable (not recommended for production)

REDIS_URL=redis://user:password@host:6379
# REQUIRED if QUEUE_MODE=bullmq: Redis connection URL from Railway
# OR use RATE_LIMIT_REDIS_URL if same Redis instance

RATE_LIMIT_REDIS_URL=redis://user:password@host:6379
# OPTIONAL: Separate Redis for rate limiting (if not set, uses REDIS_URL)
# If both REDIS_URL and RATE_LIMIT_REDIS_URL are set, rate limiting uses RATE_LIMIT_REDIS_URL

RATE_LIMIT_ENABLED=true
# REQUIRED: Must be 'true' in production

# Worker Configuration (for Railway Worker service)
WORKER_MODE=0
# REQUIRED for API service: Must be '0' or not set (API mode)
# Set to '1' only in Worker service

JOB_RUNNER_ENABLED=false
# REQUIRED for API service: Must be 'false' (jobs run in separate Worker service)
# Set to 'true' only in Worker service

# ============================================
# REQUIRED - Webhook Security (Production)
# ============================================

WHATSAPP_APP_SECRET=your_whatsapp_app_secret_from_meta
# REQUIRED: WhatsApp App Secret from Meta Developer Console
# Used for webhook signature validation (X-Hub-Signature-256)
# If missing, webhooks will be rejected with 401/403

META_APP_SECRET=your_meta_app_secret_from_meta
# REQUIRED: Meta App Secret from Meta Developer Console
# Used for Instagram and Meta Lead Ads webhook signature validation
# If missing, webhooks will be rejected with 401/403

# ============================================
# REQUIRED - Observability
# ============================================

METRICS_TOKEN=your-secure-random-token-for-metrics-endpoint
# REQUIRED: Token for /api/metrics endpoint (X-Metrics-Token header)
# Use strong random string (min 32 characters)
# This token allows access to Prometheus metrics without JWT

# ============================================
# OPTIONAL - Application Configuration
# ============================================

NODE_ENV=production
# OPTIONAL: Set automatically by Railway, but can be set explicitly

PORT=4000
# OPTIONAL: Port for API server (default: 4000, Railway sets this automatically)

AUDIT_FAIL_MODE=CLOSED
# OPTIONAL: Audit log failure mode
# - OPEN: Continue on audit log failure (dev/staging)
# - CLOSED: Fail request on audit log failure (production, recommended)

APP_VERSION=1.0.0
# OPTIONAL: Application version for metrics labels

# ============================================
# OPTIONAL - Meta OAuth (if using Meta integrations)
# ============================================

META_APP_ID=your_meta_app_id
# OPTIONAL: Meta App ID (required only if using Meta OAuth)

# ============================================
# NOTES
# ============================================
# - All REQUIRED variables must be set for production
# - Use Railway environment variables or secrets management
# - Never commit actual secrets to git
# - Rotate secrets regularly
# - Use different secrets for staging and production
